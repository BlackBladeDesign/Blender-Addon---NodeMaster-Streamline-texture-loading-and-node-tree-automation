
import bpy

class CustomPropertyAdder:
    @staticmethod
    def add_custom_property(prop_name, prop_value, apply_to):
        if apply_to == "SELECTED":
            obj = bpy.context.active_object
            if obj is not None:
                obj[prop_name] = prop_value
        elif apply_to == "ALL_ATTACHED":
            obj = bpy.context.active_object
            if obj is not None:
                for mat_slot in obj.material_slots:
                    mat = mat_slot.material
                    if mat is not None:
                        mat[prop_name] = prop_value
        elif apply_to == "ALL_VISIBLE":
            for obj in bpy.context.visible_objects:
                obj[prop_name] = prop_value